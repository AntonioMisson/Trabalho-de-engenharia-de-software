<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Agendamento</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    .schedule-button.available {
      background-color: #f0f0f0;
      color: black;
    }
    .schedule-button.selected-by-user {
      background-color: green;
      color: white;
    }
    .schedule-button.booked {
      background-color: red;
      color: white;
    }
    form {
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="schedule-container">
    <h2 class="schedule-title">Agendamento de horários</h2>
    <table class="schedule-table">
      <thead>
        <tr>
          <th>Horários</th>
          {% for dia in dias %}
            <th>{{ dia }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for hora in horarios %}
        <tr>
          <td class="hour-cell">{{ hora }}</td>
          {% for dia in dias %}
            {% set chave = dia ~ '-' ~ hora|replace(':', '') %}
            <td>
              <form method="POST" action="{{ url_for('horario') }}">
                <input type="hidden" name="dia" value="{{ dia }}">
                <input type="hidden" name="hora" value="{{ hora }}">
                {% if agendados.get(chave) %}
                  {% if agendados.get(chave) == usuario %}
                    <button class="schedule-button selected-by-user" disabled>
                      {{ hora }}
                    </button>
                  {% else %}
                    <button class="schedule-button booked" disabled>
                      {{ hora }}
                    </button>
                  {% endif %}
                {% else %}
                  <button type="submit" class="schedule-button available">
                    {{ hora }}
                  </button>
                {% endif %}
              </form>
            </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
